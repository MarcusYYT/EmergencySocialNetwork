doctype html
html(lang='en')
  head
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')
    link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css', rel='stylesheet', integrity='sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3', crossorigin='anonymous')
    link(rel='stylesheet', type='text/css', href='/stylesheets/index.css')
    script(src='/javascripts/directory.js')
    title Directory 
  body
    .links
      a.btn.btn-primary(onclick='newPost()') New Post
      a.btn.btn-primary(onclick='logout()') Log Out
    #directory-wrapper
      h1#directory-header ESN Directory
      #directory
    script.
      function newPost() {
      const user_id = #{user_id};
      window.location.href = `/messageWall/${user_id}`;
      }
      async function logout(){
      const userId = #{user_id};
      const requestBody = {
      user_id: userId,
      updateAt: "online_status",
      updateValue: "offline"
      }
      await fetch(`/users/${userId}`, {
      method: 'PUT',
      headers: {
      'Content-Type': 'application/json',
      },
      body: JSON.stringify(requestBody),
      }).then(response=> response.json()).then((data)=>{
        console.log(data.message)
      })
      window.location.href = `/`;
      }
      //- window.addEventListener('beforeunload', async function(event) {
      //- console.log('Browser is closing');
      //- await logout()
      //- });
        


    
